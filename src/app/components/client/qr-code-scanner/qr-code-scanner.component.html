<!DOCTYPE html>
<html>
<head>
  <title>QR Code Scanner</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
<div class="flex justify-center items-center min-h-screen">
  <div class="bg-white p-8 rounded-lg shadow-lg">
    <h1 class="text-2xl font-bold mb-4">QR Code Scanner</h1>
    <div class="mb-4">
      <input type="file" id="fileInput" accept="image/*" class="border border-gray-300 rounded-md px-3 py-2" />
    </div>
    <button id="scanButton" disabled class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50 disabled:cursor-not-allowed">
      Scan QR Code
    </button>
    <p id="result" class="mt-4 text-green-500"></p>
  </div>
</div>

<script>
  const fileInput = document.getElementById('fileInput');
  const scanButton = document.getElementById('scanButton');
  const resultElement = document.getElementById('result');

  fileInput.addEventListener('change', (event) => {
    const file = event.target.files[0];
    scanButton.disabled = !file;
  });

  scanButton.addEventListener('click', () => {
    const file = fileInput.files[0];
    const formData = new FormData();
    formData.append('file', file);

    fetch('http://localhost:9090/api/qr/scan', {
      method: 'POST',
      body: formData
    })
      .then(response => response.text())
      .then(decodedText => {
        resultElement.textContent = `Decoded QR code: ${decodedText}`;
        window.location.href = decodedText;
      })
      .catch(error => {
        resultElement.textContent = `Error scanning QR code: ${error}`;
        resultElement.classList.remove('text-green-500');
        resultElement.classList.add('text-red-500');
        console.error('Error scanning QR code:', error);
      });
  });

</script>
</body>
</html>
